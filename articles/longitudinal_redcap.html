<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with Longitudinal REDCap Databases • REDCapTidieR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Working with Longitudinal REDCap Databases">
<meta property="og:description" content="REDCapTidieR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">REDCapTidieR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/REDCapTidieR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/longitudinal_redcap.html">Working with Longitudinal REDCap Databases</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CHOP-CGTDataOps/REDCapTidieR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Working with Longitudinal REDCap Databases</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CHOP-CGTDataOps/REDCapTidieR/blob/HEAD/vignettes/longitudinal_redcap.Rmd" class="external-link"><code>vignettes/longitudinal_redcap.Rmd</code></a></small>
      <div class="hidden name"><code>longitudinal_redcap.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>REDCap databases support two main mechanisms to allow collecting the same data multiple times: repeated instruments and longitudinal projects.</p>
<p>The granularity of each table (i.e. what a single row represents) depends on the structure of the database (classic, longitudinal with one arm, longitudinal with multiple arms) as well as whether the instruments are repeatable or not. Based on this, <code>REDCapTidieR</code> tibbles contain the following columns to uniquely identify a specific row:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="17%">
<col width="25%">
<col width="28%">
<col width="28%">
</colgroup>
<thead><tr class="header">
<th></th>
<th><strong>Classic</strong></th>
<th><strong>Longitudinal, one arm</strong></th>
<th><strong>Longitudinal, multi-arm</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Nonrepeated</strong></td>
<td><code>record_id</code></td>
<td>
<code>record_id</code> +<br><code>redcap_event</code>
</td>
<td>
<code>record_id</code> +<br><code>redcap_event</code> +<br><code>redcap_arm</code>
</td>
</tr>
<tr class="even">
<td><strong>Repeated</strong></td>
<td>
<code>record_id</code> +<br><code>redcap_repeat_instance</code>
</td>
<td>
<code>record_id</code> +<br><code>redcap_repeat_instance</code> +<br><code>redcap_event</code>
</td>
<td>
<code>record_id</code> +<br><code>redcap_repeat_instance</code> +<br><code>redcap_event</code> +<br><code>redcap_arm</code>
</td>
</tr>
</tbody>
</table>
<p>The <code>read_redcap_tidy</code> function returns a tibble in which each row represents a REDCap instrument. The first column contains the instrument name. The second column is a <strong>list column</strong> containing a tibble for each instrument. The third column indicates the repeat/nonrepeat structure of the instrument.</p>
<p>Let’s use a sample longitudinal REDCap database containing repeat instruments, longitudinal events, and multiple event arms:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/CHOP-CGTDataOps/REDCapTidieR" class="external-link">REDCapTidieR</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">redcap_export</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_redcap_tidy.html">read_redcap_tidy</a></span><span class="op">(</span><span class="va">redcap_uri</span>, <span class="va">token</span><span class="op">)</span></span>
<span></span>
<span><span class="va">redcap_export</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   redcap_form_name redcap_data      structure   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> repeated         <span style="color: #949494;">&lt;tibble [9 × 7]&gt;</span> repeating   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> nonrepeated      <span style="color: #949494;">&lt;tibble [8 × 6]&gt;</span> nonrepeating</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> nonrepeated2     <span style="color: #949494;">&lt;tibble [3 × 6]&gt;</span> nonrepeating</span></span></code></pre></div>
<p>Here we have a database with two nonrepeating instruments and one repeating instrument. Let’s look at a sample nonrepeated data output first:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">redcap_export</span><span class="op">$</span><span class="va">redcap_data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 6</span></span></span>
<span><span class="co">#&gt;   record_id redcap_event redcap_arm nonrepeat_1 nonrepeat_2 form_status_complete</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1 event_1               1 1           2           Incomplete          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         1 event_2               1 1           2           Incomplete          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>         2 event_1               1 A           B           Incomplete          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>         2 event_2               1 5           6           Incomplete          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>         3 event_1               1 <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>          Incomplete          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>         3 event_2               1 <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>          Incomplete          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>         4 event_1               2 Red         Blue        Incomplete          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>         4 event_3               2 Green       Yellow      Incomplete</span></span></code></pre></div>
<p>While in classic databases we would expect only unique <code>record_id</code>s per row, in a longitudinal database <code>record_id</code>s can appear multiple times based on both the event (<code>redcap_event</code>) and arm (<code>redcap_arm</code>) where forms and their respective variables appear. This is illustrated in the earlier table depicting what columns are necessary to uniquely identify rows.</p>
<p>Now let’s look at the repeated instrument data output:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">redcap_export</span><span class="op">$</span><span class="va">redcap_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 7</span></span></span>
<span><span class="co">#&gt;   record_id redcap_repeat_instance redcap_event redcap…¹ repea…² repea…³ form_…⁴</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         1                      1 event_1             1 1       2       Incomp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         1                      2 event_1             1 3       4       Incomp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>         1                      3 event_1             1 5       6       Incomp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>         1                      1 event_2             1 A       B       Incomp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>         1                      2 event_2             1 C       D       Incomp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>         3                      1 event_1             1 C       D       Incomp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>         3                      1 event_2             1 E       F       Incomp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>         3                      2 event_2             1 G       H       Incomp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>         4                      1 event_3             2 R1      R2      Incomp…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable names ¹​redcap_arm, ²​repeat_1, ³​repeat_2,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ⁴​form_status_complete</span></span></span></code></pre></div>
<p>The only really noticeable difference here is the inclusion of <code>redcap_repeat_instance</code>. This adds a further level of complexity, allowing a single instrument to have repeating values of variable length for a given record.</p>
<div class="section level3">
<h3 id="single-arm-longitudinal-redcap-databases">Single-Arm Longitudinal REDCap Databases<a class="anchor" aria-label="anchor" href="#single-arm-longitudinal-redcap-databases"></a>
</h3>
<p>By default, longitudinal REDCap databases are automatically assigned arms. We have found that if the database does not make use of more than the single default arm the assignment of arms is redundant. Therefore, <code>redcap_arm</code> will only appear in data ouputs if more than one arm are detected in a database.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Richard Hanna, Stephan Kadauke.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
